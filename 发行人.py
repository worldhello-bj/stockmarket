# -*- coding: utf-8 -*-
"""
发行人.py
定义发行人类及相关变量
"""

from 股民 import 基础股民
from 市场撮合引擎 import 委托单

股票名称列表 = ["地产股", "科技股", "医药股"]
发行新股数量 = 10000

class 发行人(基础股民):
    def __init__(自身):
        super().__init__("发行人", 0, 0)
        自身.个股信心表 = {名称: 100 for 名称 in 股票名称列表}
        自身.持仓数量表 = {名称: 发行新股数量 for 名称 in 股票名称列表}
        自身.买卖尝试表 = {}

    def 生成委托单(自身, 股票名称, 当前价格字典, 引擎):
        # 发行人只卖出新股，不买入
        持仓数量 = 自身.持仓数量表.get(股票名称, 0)
        if 持仓数量 > 0:
            最新价 = 引擎.最新成交价(股票名称) or 当前价格字典[股票名称]
            委托价格 = round(最新价, 2)
            委托数量 = max(1, 持仓数量 // 10)
            if 委托数量 > 持仓数量:
                委托数量 = 持仓数量
            return 委托单(自身, 股票名称, '卖', 委托价格, 委托数量)
        return None